# Milvus란 무엇인가?

Milvus는 매과(Accipaitridae) Milvus 속의 맹금류로, 빠른 비행 속도, 예리한 시야, 그리고 뛰어난 적응력으로 유명합니다.

Zilliz는 노트북부터 대규모 분산 시스템까지 다양한 환경에서 효율적으로 실행되는 오픈소스 고성능, 확장 가능한 벡터 데이터베이스에 Milvus라는 이름을 채택했습니다. 오픈소스 소프트웨어와 클라우드 서비스 모두로 제공됩니다.

Zilliz에서 개발하고 곧 Linux Foundation 산하의 LF AI & Data Foundation에 기부된 Milvus는 세계 최고의 오픈소스 벡터 데이터베이스 프로젝트 중 하나가 되었습니다. Apache 2.0 라이선스로 배포되며, 대부분의 기여자는 대규모 시스템 구축과 하드웨어 인식 코드 최적화를 전문으로 하는 고성능 컴퓨팅(HPC) 커뮤니티의 전문가들입니다. 핵심 기여자들은 Zilliz, ARM, NVIDIA, AMD, Intel, Meta, IBM, Salesforce, Alibaba, Microsoft의 전문가들로 구성되어 있습니다.

흥미롭게도, 모든 Zilliz 오픈소스 프로젝트는 새의 이름을 따서 명명되는데, 이는 자유, 선견지명, 그리고 기술의 민첩한 진화를 상징하는 명명 규칙입니다.

## 비정형 데이터, 임베딩, 그리고 Milvus

텍스트, 이미지, 오디오와 같은 비정형 데이터는 형식이 다양하고 풍부한 기본 의미를 담고 있어 분석하기 어렵습니다. 이러한 복잡성을 관리하기 위해 임베딩을 사용하여 비정형 데이터를 그 핵심 특성을 포착하는 수치 벡터로 변환합니다. 이러한 벡터는 벡터 데이터베이스에 저장되어 빠르고 확장 가능한 검색 및 분석을 가능하게 합니다.

Milvus는 강력한 데이터 모델링 기능을 제공하여 비정형 또는 멀티모달 데이터를 구조화된 컬렉션으로 구성할 수 있게 해줍니다. 일반적인 수치 및 문자 타입, 다양한 벡터 타입, 배열, 집합, JSON을 포함하여 다양한 속성 모델링을 위한 광범위한 데이터 타입을 지원하므로 여러 데이터베이스 시스템을 유지 관리하는 번거로움을 덜어줍니다.

## 배포 모드

Milvus는 Jupyter Notebook에서의 로컬 프로토타이핑부터 수백억 개의 벡터를 관리하는 대규모 Kubernetes 클러스터까지 광범위한 데이터 규모를 포괄하는 세 가지 배포 모드를 제공합니다:

- **Milvus Lite**는 애플리케이션에 쉽게 통합할 수 있는 Python 라이브러리입니다. Milvus의 경량 버전으로, Jupyter Notebook에서의 빠른 프로토타이핑이나 제한된 리소스를 가진 엣지 디바이스에서 실행하기에 이상적입니다.
- **Milvus Standalone**은 단일 머신 서버 배포로, 모든 구성 요소가 편리한 배포를 위해 단일 Docker 이미지로 번들됩니다.
- **Milvus Distributed**는 Kubernetes 클러스터에 배포할 수 있으며, 10억 규모 또는 그 이상의 시나리오를 위해 설계된 클라우드 네이티브 아키텍처를 특징으로 합니다. 이 아키텍처는 중요한 구성 요소의 중복성을 보장합니다.

## Milvus를 빠르게 만드는 요소는 무엇인가？

Milvus는 처음부터 고효율 벡터 데이터베이스 시스템으로 설계되었습니다. 대부분의 경우 Milvus는 다른 벡터 데이터베이스보다 2-5배 뛰어난 성능을 보입니다(VectorDBBench 결과 참조). 이러한 고성능은 여러 주요 설계 결정의 결과입니다:

### 하드웨어 인식 최적화
다양한 하드웨어 환경에서 Milvus를 수용하기 위해 AVX512, SIMD, GPU, NVMe SSD를 포함한 많은 하드웨어 아키텍처와 플랫폼에 특화된 성능 최적화를 수행했습니다.

### 고급 검색 알고리즘
Milvus는 IVF, HNSW, DiskANN 등을 포함하여 광범위한 인메모리 및 온디스크 인덱싱/검색 알고리즘을 지원하며, 이 모든 것이 깊이 최적화되었습니다. FAISS 및 HNSWLib과 같은 인기 있는 구현과 비교하여 Milvus는 30%-70% 더 나은 성능을 제공합니다.

### C++로 구현된 검색 엔진
벡터 데이터베이스 성능의 80% 이상은 검색 엔진에 의해 결정됩니다. Milvus는 언어의 고성능, 저수준 최적화, 효율적인 리소스 관리 때문에 이 중요한 구성 요소에 C++를 사용합니다. 가장 중요한 것은 Milvus가 어셈블리 수준 벡터화부터 멀티스레드 병렬화 및 스케줄링까지 수많은 하드웨어 인식 코드 최적화를 통합하여 하드웨어 기능을 완전히 활용한다는 점입니다.

### 컬럼 지향
Milvus는 컬럼 지향 벡터 데이터베이스 시스템입니다. 주요 장점은 데이터 액세스 패턴에서 비롯됩니다. 쿼리를 수행할 때 컬럼 지향 데이터베이스는 전체 행이 아닌 쿼리에 관련된 특정 필드만 읽어 액세스되는 데이터의 양을 크게 줄입니다. 또한 컬럼 기반 데이터에 대한 작업은 쉽게 벡터화될 수 있어 전체 컬럼에 한 번에 작업을 적용할 수 있어 성능을 더욱 향상시킵니다.

## Milvus를 확장 가능하게 만드는 요소

2022년에 Milvus는 10억 규모의 벡터를 지원했고, 2023년에는 일관된 안정성으로 수백억 개로 확장되어 Salesforce, PayPal, Shopee, Airbnb, eBay, NVIDIA, IBM, AT&T, LINE, ROBLOX, Inflection 등 300개 이상의 주요 기업을 위한 대규모 시나리오를 지원하고 있습니다.

Milvus의 클라우드 네이티브이고 고도로 분리된 시스템 아키텍처는 데이터가 증가함에 따라 시스템이 지속적으로 확장될 수 있도록 보장합니다:

Milvus 자체는 완전히 무상태이므로 Kubernetes나 퍼블릭 클라우드의 도움으로 쉽게 확장할 수 있습니다. 또한 Milvus 구성 요소는 잘 분리되어 있으며, 가장 중요한 세 가지 작업인 검색, 데이터 삽입, 인덱싱/압축이 쉽게 병렬화할 수 있는 프로세스로 설계되어 복잡한 로직이 분리되어 있습니다. 이것은 해당하는 쿼리 노드, 데이터 노드, 인덱스 노드가 독립적으로 스케일 업 및 스케일 아웃할 수 있도록 보장하여 성능과 비용 효율성을 최적화합니다.

## Milvus가 지원하는 검색 유형

Milvus는 다양한 사용 사례의 요구를 충족하기 위해 다양한 검색 기능을 지원합니다:

- **ANN 검색**: 쿼리 벡터에 가장 가까운 상위 K개 벡터를 찾습니다.
- **필터링 검색**: 지정된 필터링 조건 하에서 ANN 검색을 수행합니다.
- **범위 검색**: 쿼리 벡터로부터 지정된 반경 내의 벡터를 찾습니다.
- **하이브리드 검색**: 여러 벡터 필드를 기반으로 ANN 검색을 수행합니다.
- **전체 텍스트 검색**: BM25를 기반으로 한 전체 텍스트 검색입니다.
- **재순위**: 추가 기준이나 보조 알고리즘을 기반으로 검색 결과의 순서를 조정하여 초기 ANN 검색 결과를 정제합니다.
- **가져오기**: 기본 키로 데이터를 검색합니다.
- **쿼리**: 특정 표현식을 사용하여 데이터를 검색합니다.

## 포괄적인 기능 세트

위에서 언급한 주요 검색 기능 외에도 Milvus는 ANN 검색을 중심으로 구현된 기능 세트를 제공하여 그 기능을 완전히 활용할 수 있습니다.

### API 및 SDK

- RESTful API (공식)
- PyMilvus (Python SDK) (공식)
- Go SDK (공식)
- Java SDK (공식)
- Node.js (JavaScript) SDK (공식)
- C# (Microsoft에서 기여)
- C++ SDK (개발 중)
- Rust SDK (개발 중)

### 고급 데이터 타입

기본 데이터 타입 외에도 Milvus는 다양한 고급 데이터 타입과 해당 적용 가능한 거리 메트릭을 지원합니다.

- 희소 벡터
- 이진 벡터
- JSON 지원
- 배열 지원
- 텍스트 (개발 중)
- 지리적 위치 (개발 중)

## 왜 Milvus인가?

### 대규모 고성능 및 고가용성

Milvus는 컴퓨팅과 스토리지를 분리하는 분산 아키텍처를 특징으로 합니다. Milvus는 수평으로 확장하고 다양한 트래픽 패턴에 적응할 수 있으며, 읽기 집약적 워크로드를 위해 쿼리 노드를 독립적으로 증가시키고 쓰기 집약적 워크로드를 위해 데이터 노드를 증가시켜 최적의 성능을 달성합니다. K8s의 무상태 마이크로서비스는 장애로부터 빠른 복구를 가능하게 하여 고가용성을 보장합니다. 레플리카 지원은 여러 쿼리 노드에 데이터 세그먼트를 로드하여 내결함성과 처리량을 더욱 향상시킵니다.

### 다양한 벡터 인덱스 타입 및 하드웨어 가속 지원

Milvus는 시스템과 핵심 벡터 검색 엔진을 분리하여 HNSW, IVF, FLAT(브루트 포스), SCANN, DiskANN을 포함하여 양자화 기반 변형 및 mmap과 함께 다양한 시나리오에 최적화된 모든 주요 벡터 인덱스 타입을 지원할 수 있게 합니다. Milvus는 메타데이터 필터링 및 범위 검색과 같은 고급 기능을 위해 벡터 검색을 최적화합니다. 또한 Milvus는 벡터 검색 성능을 향상시키기 위해 하드웨어 가속을 구현하고 NVIDIA의 CAGRA와 같은 GPU 인덱싱을 지원합니다.

### 유연한 멀티테넌시 및 핫/콜드 스토리지

Milvus는 데이터베이스, 컬렉션, 파티션 또는 파티션 키 수준에서 격리를 통해 멀티테넌시를 지원합니다. 유연한 전략을 통해 단일 클러스터가 수백에서 수백만 명의 테넌트를 처리할 수 있으며, 최적화된 검색 성능과 유연한 액세스 제어를 보장합니다. Milvus는 핫/콜드 스토리지로 비용 효율성을 향상시킵니다. 자주 액세스되는 핫 데이터는 더 나은 성능을 위해 메모리나 SSD에 저장할 수 있고, 덜 액세스되는 콜드 데이터는 더 느리지만 비용 효율적인 스토리지에 보관됩니다. 이 메커니즘은 중요한 작업을 위한 고성능을 유지하면서 비용을 크게 줄일 수 있습니다.

### 전체 텍스트 검색 및 하이브리드 검색을 위한 희소 벡터

밀집 벡터를 통한 의미적 검색 외에도 Milvus는 BM25뿐만 아니라 SPLADE 및 BGE-M3와 같은 학습된 희소 임베딩을 통한 전체 텍스트 검색을 기본적으로 지원합니다. 사용자는 동일한 컬렉션에 희소 벡터와 밀집 벡터를 저장하고 여러 검색 요청의 결과를 재순위화하는 함수를 정의할 수 있습니다.

### 데이터 보안 및 세밀한 액세스 제어

Milvus는 필수 사용자 인증, TLS 암호화, 역할 기반 액세스 제어(RBAC)를 구현하여 데이터 보안을 보장합니다. 사용자 인증은 유효한 자격 증명을 가진 인증된 사용자만 데이터베이스에 액세스할 수 있도록 보장하고, TLS 암호화는 네트워크 내의 모든 통신을 보호합니다. 또한 RBAC는 역할에 따라 사용자에게 특정 권한을 할당하여 세밀한 액세스 제어를 가능하게 합니다. 이러한 기능들은 Milvus를 기업 애플리케이션에 강력하고 안전한 선택으로 만들어 민감한 데이터를 무단 액세스 및 잠재적 침해로부터 보호합니다.

## AI 통합

### 임베딩 모델 통합
임베딩 모델은 비정형 데이터를 고차원 데이터 공간에서 수치적 표현으로 변환하여 Milvus에 저장할 수 있게 합니다. 현재 Python SDK인 PyMilvus는 여러 임베딩 모델을 통합하여 데이터를 벡터 임베딩으로 빠르게 준비할 수 있습니다.

### 재순위 모델 통합
정보 검색 및 생성형 AI 영역에서 재순위기는 초기 검색 결과의 순서를 최적화하는 필수 도구입니다. PyMilvus는 또한 초기 검색에서 반환된 결과의 순서를 최적화하기 위해 여러 재순위 모델을 통합합니다.

### LangChain 및 기타 AI 도구 통합
GenAI 시대에 LangChain과 같은 도구들이 애플리케이션 개발자들로부터 많은 관심을 받고 있습니다. 핵심 구성 요소로서 Milvus는 일반적으로 이러한 도구에서 벡터 저장소 역할을 합니다.

## 도구 및 생태계

### Attu
Attu는 Milvus와 그것이 저장하는 데이터를 관리하는 데 도움이 되는 올인원 직관적 GUI입니다.

### Birdwatcher
Birdwatcher는 Milvus를 위한 디버깅 도구입니다. etcd에 연결하여 Milvus 시스템의 상태를 확인하거나 즉석에서 구성할 수 있습니다.

### Prometheus & Grafana 통합
Prometheus는 Kubernetes를 위한 오픈소스 시스템 모니터링 및 알림 툴킷입니다. Grafana는 모든 데이터 소스와 연결할 수 있는 오픈소스 시각화 스택입니다. Prometheus & Grafana를 모니터링 서비스 제공자로 사용하여 Milvus 분산의 성능을 시각적으로 모니터링할 수 있습니다.

### Milvus 백업
Milvus 백업은 사용자가 Milvus 데이터를 백업하고 복원할 수 있게 해주는 도구입니다. 다양한 애플리케이션 시나리오에 맞게 CLI와 API를 모두 제공합니다.

### Milvus 캡처 데이터 변경 (CDC)
Milvus-CDC는 Milvus 인스턴스의 증분 데이터를 캡처하고 동기화할 수 있으며, 소스와 대상 인스턴스 간에 원활하게 전송하여 비즈니스 데이터의 신뢰성을 보장하고 쉬운 증분 백업 및 재해 복구를 가능하게 합니다.

### Milvus 커넥터
Milvus는 Apache Spark와 같은 타사 도구와 원활하게 통합할 수 있는 커넥터 세트를 계획했습니다. 현재 Spark 커넥터를 사용하여 Milvus 데이터를 기계 학습 처리를 위해 Apache Spark에 공급할 수 있습니다.

### 벡터 전송 서비스 (VTS)
Milvus는 Zilliz 클러스터, Elasticsearch, Postgres (PgVector), 다른 Milvus 인스턴스를 포함한 여러 데이터 소스와 Milvus 인스턴스 간에 데이터를 전송할 수 있는 도구 세트를 제공합니다. 